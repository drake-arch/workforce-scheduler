<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Atomix Workforce Scheduler</title>

  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-black">
  <div id="root"></div>

  <script type="text/babel">
    const { useMemo, useState } = React;

    const AtomixLogo = () => {
      // Inline SVG (no image file needed)
      // Approximates your Atomix mark: circular arrows + hex + "atomix" wordmark
      return (
        <div className="flex items-center gap-3 select-none">
          <svg
            className="h-10 w-10"
            viewBox="0 0 64 64"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            aria-hidden="true"
          >
            {/* Outer circle */}
            <circle cx="32" cy="32" r="26" stroke="#86EFAC" strokeWidth="3" opacity="0.95" />

            {/* Arrow (top-right, clockwise) */}
            <path
              d="M47 18a22 22 0 0 1 6 16"
              stroke="#86EFAC"
              strokeWidth="3"
              strokeLinecap="round"
            />
            <path
              d="M53 34l-3-3m3 3l-4 1"
              stroke="#86EFAC"
              strokeWidth="3"
              strokeLinecap="round"
              strokeLinejoin="round"
            />

            {/* Arrow (bottom-left, clockwise) */}
            <path
              d="M17 46a22 22 0 0 1-6-16"
              stroke="#86EFAC"
              strokeWidth="3"
              strokeLinecap="round"
            />
            <path
              d="M11 30l3 3m-3-3l4-1"
              stroke="#86EFAC"
              strokeWidth="3"
              strokeLinecap="round"
              strokeLinejoin="round"
            />

            {/* Hex/cube-ish icon */}
            <path
              d="M32 18l14 8v12l-14 8-14-8V26l14-8Z"
              stroke="#86EFAC"
              strokeWidth="3"
              strokeLinejoin="round"
            />
            <path
              d="M32 18v28"
              stroke="#86EFAC"
              strokeWidth="3"
              opacity="0.85"
            />
            <path
              d="M18 26l14 8 14-8"
              stroke="#86EFAC"
              strokeWidth="3"
              opacity="0.85"
              strokeLinejoin="round"
            />
          </svg>

          <div className="text-green-200 font-semibold tracking-wide text-2xl leading-none">
            <span className="text-green-200">atomix</span>
          </div>
        </div>
      );
    };

    const StatCard = ({ label, value, valueClass = "text-white" }) => (
      <div className="bg-gray-900 rounded-2xl p-5 border border-gray-800 shadow-sm">
        <div className="text-sm text-gray-400 mb-2">{label}</div>
        <div className={`text-3xl font-bold ${valueClass}`}>{value}</div>
      </div>
    );

    const WorkforceScheduler = () => {
      const [ordersPerWeek, setOrdersPerWeek] = useState(25000);
      const [totalEmployees, setTotalEmployees] = useState(50);
      const [ordersPerPersonHour, setOrdersPerPersonHour] = useState(12.5);
      const [otMultiplier, setOtMultiplier] = useState(1.5);

      const [shifts, setShifts] = useState([
        {
          id: 1,
          name: "First Shift",
          startTime: "6:00 AM",
          duration: 10,
          days: ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
          peoplePerDay: 20,
        },
        {
          id: 2,
          name: "Second Shift",
          startTime: "12:00 PM",
          duration: 10,
          days: ["Sunday", "Monday", "Tuesday", "Wednesday"],
          peoplePerDay: 20,
        },
      ]);

      const daysOfWeek = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];

      const addShift = () => {
        setShifts((prev) => [
          ...prev,
          {
            id: Date.now(),
            name: `Shift ${prev.length + 1}`,
            startTime: "8:00 AM",
            duration: 8,
            days: ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
            peoplePerDay: 10,
          },
        ]);
      };

      const removeShift = (id) => setShifts((prev) => prev.filter((s) => s.id !== id));
      const updateShift = (id, field, value) =>
        setShifts((prev) => prev.map((s) => (s.id === id ? { ...s, [field]: value } : s)));

      const toggleDay = (shiftId, day) => {
        setShifts((prev) =>
          prev.map((s) => {
            if (s.id !== shiftId) return s;
            const days = s.days.includes(day) ? s.days.filter((d) => d !== day) : [...s.days, day];
            return { ...s, days };
          })
        );
      };

      const calculations = useMemo(() => {
        const hoursNeededPerWeek = ordersPerWeek / ordersPerPersonHour;
        let totalHoursProvided = 0;
        let totalEmployeesUsed = 0;

        shifts.forEach((shift) => {
          const hoursPerWeek = shift.days.length * shift.duration * shift.peoplePerDay;
          totalHoursProvided += hoursPerWeek;

          const employeesInShift = ((shift.days.length * shift.duration) / 40) * shift.peoplePerDay;
          totalEmployeesUsed += Math.ceil(employeesInShift);
        });

        const coverage = (totalHoursProvided / hoursNeededPerWeek) * 100;

        const employeeHoursMap = new Map();
        shifts.forEach((shift) => {
          const hoursPerWeekPerPerson = shift.duration * shift.days.length;
          for (let i = 0; i < shift.peoplePerDay; i++) {
            const empId = `${shift.name}-${i}`;
            employeeHoursMap.set(empId, (employeeHoursMap.get(empId) || 0) + hoursPerWeekPerPerson);
          }
        });

        let regularTime = 0, minorOT = 0, moderateOT = 0, heavyOT = 0, totalOTHours = 0;
        employeeHoursMap.forEach((hours) => {
          if (hours <= 40) regularTime++;
          else if (hours <= 45) { minorOT++; totalOTHours += hours - 40; }
          else if (hours <= 50) { moderateOT++; totalOTHours += hours - 40; }
          else { heavyOT++; totalOTHours += hours - 40; }
        });

        const totalPeopleAnalyzed = employeeHoursMap.size;
        const peopleOnOT = minorOT + moderateOT + heavyOT;
        const otPercentage = totalPeopleAnalyzed ? (peopleOnOT / totalPeopleAnalyzed) * 100 : 0;

        return {
          hoursNeededPerWeek,
          coverage,
          totalEmployeesUsed,
          otRisk: { regularTime, minorOT, moderateOT, heavyOT, totalPeopleAnalyzed, otPercentage }
        };
      }, [ordersPerWeek, ordersPerPersonHour, shifts]);

      const weeklyGrid = useMemo(() => {
        const grid = {};
        daysOfWeek.forEach((day) => (grid[day] = shifts.filter((s) => s.days.includes(day))));
        return grid;
      }, [shifts]);

      const exportCSV = () => {
        let csv = "Atomix Workforce Schedule\n\n";
        csv += `Orders Per Week,${ordersPerWeek}\n`;
        csv += `Total Employees,${totalEmployees}\n`;
        csv += `Coverage,${calculations.coverage.toFixed(1)}%\n\n`;
        csv += "Day,Shifts,People,Hours\n";

        daysOfWeek.forEach((day) => {
          const dayShifts = weeklyGrid[day];
          const people = dayShifts.reduce((sum, s) => sum + s.peoplePerDay, 0);
          const hours = dayShifts.reduce((sum, s) => sum + s.peoplePerDay * s.duration, 0);
          csv += `${day},${dayShifts.length},${people},${hours}\n`;
        });

        const blob = new Blob([csv], { type: "text/csv" });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "atomix_schedule.csv";
        a.click();
      };

      return (
        <div className="min-h-screen bg-black text-white">
          {/* Header that matches your screenshot layout */}
          <header className="bg-gray-900 border-b border-gray-800">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 py-4">
              {/* Top row: logo left, export right */}
              <div className="flex items-center justify-between gap-3">
                <AtomixLogo />
                <button
                  onClick={exportCSV}
                  className="px-5 py-3 rounded-xl bg-green-300 text-black font-semibold hover:bg-green-200 flex items-center justify-center"
                >
                  <svg className="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 10v6m0 0l-3-3m3 3l3-3" />
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 20h16" />
                  </svg>
                  Export CSV
                </button>
              </div>

              <div className="border-t border-gray-800 mt-4 pt-5">
                <h1 className="text-3xl sm:text-4xl font-semibold tracking-tight">
                  Workforce Scheduler
                </h1>
                <p className="text-gray-400 mt-2">
                  High-Touch Scheduling for High-Growth Teams
                </p>
              </div>
            </div>
          </header>

          <main className="max-w-7xl mx-auto px-4 sm:px-6 py-6 sm:py-8">
            {/* Top Stats */}
            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
              <StatCard label="Hours Needed" value={Math.round(calculations.hoursNeededPerWeek)} />
              <StatCard
                label="Coverage"
                value={`${calculations.coverage.toFixed(0)}%`}
                valueClass={calculations.coverage >= 100 ? "text-green-300" : "text-red-400"}
              />
              <StatCard label="Employees" value={`${calculations.totalEmployeesUsed}/${totalEmployees}`} />
              <StatCard
                label="OT Risk"
                value={`${calculations.otRisk.otPercentage.toFixed(0)}%`}
                valueClass={calculations.otRisk.otPercentage > 30 ? "text-red-400" : "text-green-300"}
              />
            </div>

            {/* Settings + Shifts */}
            <div className="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
              {/* Settings */}
              <section className="bg-gray-900 rounded-2xl p-5 border border-gray-800">
                <h2 className="text-xl font-semibold text-green-300 mb-4">Settings</h2>
                <div className="space-y-4">
                  <div>
                    <label className="block text-sm text-gray-400 mb-2">Orders/Week</label>
                    <input
                      type="number"
                      value={ordersPerWeek}
                      onChange={(e) => setOrdersPerWeek(Number(e.target.value))}
                      className="w-full px-4 py-3 bg-black border border-gray-700 rounded-xl text-white"
                      inputMode="numeric"
                    />
                  </div>
                  <div>
                    <label className="block text-sm text-gray-400 mb-2">Employees</label>
                    <input
                      type="number"
                      value={totalEmployees}
                      onChange={(e) => setTotalEmployees(Number(e.target.value))}
                      className="w-full px-4 py-3 bg-black border border-gray-700 rounded-xl text-white"
                      inputMode="numeric"
                    />
                  </div>
                  <div>
                    <label className="block text-sm text-gray-400 mb-2">Orders/Person/Hr</label>
                    <input
                      type="number"
                      step="0.5"
                      value={ordersPerPersonHour}
                      onChange={(e) => setOrdersPerPersonHour(Number(e.target.value))}
                      className="w-full px-4 py-3 bg-black border border-gray-700 rounded-xl text-white"
                      inputMode="decimal"
                    />
                  </div>
                  <div>
                    <label className="block text-sm text-gray-400 mb-2">OT Multiplier</label>
                    <input
                      type="number"
                      step="0.1"
                      value={otMultiplier}
                      onChange={(e) => setOtMultiplier(Number(e.target.value))}
                      className="w-full px-4 py-3 bg-black border border-gray-700 rounded-xl text-white"
                      inputMode="decimal"
                    />
                  </div>
                </div>
              </section>

              {/* Shifts */}
              <section className="lg:col-span-2 bg-gray-900 rounded-2xl p-5 border border-gray-800">
                <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4">
                  <h2 className="text-xl font-semibold text-green-300">Shifts</h2>
                  <button
                    onClick={addShift}
                    className="w-full sm:w-auto px-5 py-3 rounded-xl bg-green-300 text-black font-semibold hover:bg-green-200"
                  >
                    + Add Shift
                  </button>
                </div>

                <div className="space-y-4">
                  {shifts.map((shift) => (
                    <div key={shift.id} className="bg-black border border-gray-700 rounded-2xl p-4">
                      <div className="grid grid-cols-1 sm:grid-cols-12 gap-3 mb-3">
                        <div className="sm:col-span-3">
                          <input
                            type="text"
                            value={shift.name}
                            onChange={(e) => updateShift(shift.id, "name", e.target.value)}
                            className="w-full px-3 py-3 sm:py-2 bg-gray-900 border border-gray-700 rounded-xl text-white"
                            placeholder="Shift name"
                          />
                        </div>
                        <div className="sm:col-span-3">
                          <input
                            type="text"
                            value={shift.startTime}
                            onChange={(e) => updateShift(shift.id, "startTime", e.target.value)}
                            className="w-full px-3 py-3 sm:py-2 bg-gray-900 border border-gray-700 rounded-xl text-white"
                            placeholder="6:00 AM"
                          />
                        </div>
                        <div className="sm:col-span-2">
                          <input
                            type="number"
                            value={shift.duration}
                            onChange={(e) => updateShift(shift.id, "duration", Number(e.target.value))}
                            className="w-full px-3 py-3 sm:py-2 bg-gray-900 border border-gray-700 rounded-xl text-white"
                            inputMode="numeric"
                          />
                        </div>
                        <div className="sm:col-span-2">
                          <input
                            type="number"
                            value={shift.peoplePerDay}
                            onChange={(e) => updateShift(shift.id, "peoplePerDay", Number(e.target.value))}
                            className="w-full px-3 py-3 sm:py-2 bg-gray-900 border border-gray-700 rounded-xl text-white"
                            inputMode="numeric"
                          />
                        </div>
                        <div className="sm:col-span-2">
                          <button
                            onClick={() => removeShift(shift.id)}
                            className="w-full px-3 py-3 sm:py-2 rounded-xl bg-red-900/30 text-red-300 hover:bg-red-900/50"
                          >
                            Remove
                          </button>
                        </div>
                      </div>

                      <div className="flex flex-wrap gap-2">
                        {daysOfWeek.map((day) => (
                          <button
                            key={day}
                            onClick={() => toggleDay(shift.id, day)}
                            className={`px-3 py-2 rounded-xl text-sm font-medium ${
                              shift.days.includes(day) ? "bg-green-500 text-white" : "bg-gray-800 text-gray-300"
                            }`}
                          >
                            {day.substring(0, 3)}
                          </button>
                        ))}
                      </div>
                    </div>
                  ))}
                </div>
              </section>
            </div>

            {/* Weekly Schedule */}
            <section className="bg-gray-900 rounded-2xl p-5 border border-gray-800 mb-8">
              <h2 className="text-xl font-semibold text-green-300 mb-4">Weekly Schedule</h2>

              <div className="overflow-x-auto -mx-4 sm:mx-0">
                <div className="min-w-[720px] px-4 sm:px-0">
                  <table className="w-full">
                    <thead>
                      <tr className="border-b border-gray-700">
                        <th className="text-left py-3 px-4 text-gray-400">Day</th>
                        <th className="text-left py-3 px-4 text-gray-400">Shifts</th>
                        <th className="text-right py-3 px-4 text-gray-400">People</th>
                        <th className="text-right py-3 px-4 text-gray-400">Hours</th>
                      </tr>
                    </thead>
                    <tbody>
                      {daysOfWeek.map((day) => {
                        const dayShifts = weeklyGrid[day];
                        const totalPeople = dayShifts.reduce((sum, s) => sum + s.peoplePerDay, 0);
                        const totalHours = dayShifts.reduce((sum, s) => sum + s.peoplePerDay * s.duration, 0);
                        return (
                          <tr key={day} className="border-b border-gray-800">
                            <td className="py-3 px-4 font-medium">{day}</td>
                            <td className="py-3 px-4">{dayShifts.length ? dayShifts.map(s => s.name).join(", ") : "No shifts"}</td>
                            <td className="py-3 px-4 text-right font-semibold">{totalPeople}</td>
                            <td className="py-3 px-4 text-right">{totalHours}h</td>
                          </tr>
                        );
                      })}
                    </tbody>
                  </table>
                </div>
              </div>
            </section>
          </main>
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<WorkforceScheduler />);
  </script>
</body>
</html>
